<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruijie Solution Configurator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }

        /* 隐藏 Chrome, Safari, Edge, Opera 的上下箭头 */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* 隐藏 Firefox 的上下箭头 */
        input[type=number] {
            -moz-appearance: textfield;
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .custom-shadow {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05);
        }

        @media print {
            .no-print { display: none !important; }
            body { background-color: white; }
            .step-content { display: block !important; }
            .custom-shadow { box-shadow: none; border: 1px solid #eee; }
            #step-result { padding: 0; }
        }
    </style>
</head>
<body class="text-slate-800">

    <div id="app" class="min-h-screen flex flex-col">
        <!-- Navigation Bar -->
        <nav class="bg-white/80 backdrop-blur-md border-b sticky top-0 z-50 no-print">
            <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white">
                        <i class="fas fa-cube"></i>
                    </div>
                    <span class="font-bold text-xl tracking-tight">Ruijie Solution Expert</span>
                </div>
                <button onclick="resetApp()" class="text-sm text-slate-500 hover:text-blue-600 transition-colors">
                    <i class="fas fa-redo-alt mr-1"></i> Reset
                </button>
            </div>
        </nav>

        <main class="flex-grow max-w-6xl mx-auto w-full px-6 py-8">
            <!-- Progress Bar -->
            <div id="progress-container" class="mb-10 transition-opacity duration-300 no-print">
                <div class="flex justify-between mb-2">
                    <span id="step-label" class="text-xs font-bold uppercase tracking-wider text-slate-400">Configuration Progress</span>
                    <span id="step-percentage" class="text-xs font-bold text-blue-600">45%</span>
                </div>
                <div class="w-full bg-slate-200 h-1.5 rounded-full">
                    <div id="progress-bar" class="bg-blue-600 h-full rounded-full transition-all duration-500" style="width: 45%"></div>
                </div>
            </div>

            <div id="wizard-container">
                
                <!-- Step 1: Office Type Selection -->
                <div id="step-office-sub" class="step-content animate-fade-in no-print">
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h2 class="text-2xl md:text-3xl font-bold mb-2">Select Office Layout</h2>
                            <p class="text-slate-500">Layout determines AP selection and coverage strategy.</p>
                        </div>
                        <!-- 返回上一步按钮，链接到 index.html -->
                        <button onclick="window.location.href='index.html'" class="px-4 py-2 bg-white border border-slate-200 text-slate-600 rounded-xl text-sm font-bold hover:bg-slate-50 transition-all flex items-center shadow-sm">
                            <i class="fas fa-chevron-left mr-2"></i>Home
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div onclick="goToParams('office_open')" class="p-6 bg-white border-2 border-slate-100 rounded-2xl cursor-pointer hover:border-blue-200 transition-all group">
                            <i class="fas fa-border-none text-3xl text-blue-500 mb-4 group-hover:scale-110 transition-transform"></i>
                            <h3 class="text-lg font-bold mb-1">Open Plan Office</h3>
                            <p class="text-sm text-slate-500">Large open space with few partitions. Focuses on high-density access.</p>
                        </div>
                        <div onclick="goToParams('office_rooms')" class="p-6 bg-white border-2 border-slate-100 rounded-2xl cursor-pointer hover:border-blue-200 transition-all group">
                            <i class="fas fa-door-closed text-3xl text-indigo-500 mb-4 group-hover:scale-110 transition-transform"></i>
                            <h3 class="text-lg font-bold mb-1">Partitioned Rooms</h3>
                            <p class="text-sm text-slate-500">Multiple independent rooms. Focuses on wall-penetration capability.</p>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Parameters -->
                <div id="step-params" class="step-content hidden animate-fade-in no-print">
                    <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">Environment Scale</h2>
                    <p class="text-center text-slate-400 mb-6 tracking-wide">Selected Type: <span id="type-info-badge" class="font-bold text-blue-600"></span></p>
                    <div class="bg-white p-8 rounded-3xl border border-slate-100 custom-shadow space-y-6 max-w-xl mx-auto">
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">1. Total Area (1-800 ㎡)</label>
                            <div class="relative">
                                <input type="number" id="input-area" min="1" placeholder="Enter value 1-800" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none text-lg">
                                <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold">㎡</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">2. Staff Count (1-100 persons)</label>
                            <div class="relative">
                                <input type="number" id="input-staff" min="1" placeholder="Enter value 1-100" class="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none text-lg">
                                <span class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 font-bold">People</span>
                            </div>
                        </div>
                        <div class="flex flex-col gap-3">
                            <button onclick="validateAndCalculate()" class="w-full py-4 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-all shadow-lg shadow-blue-100 active:scale-[0.98]">
                                Generate Recommendation
                            </button>
                            <button onclick="goBackToStep('step-office-sub', 45)" class="w-full py-3 bg-white border border-slate-200 text-slate-500 rounded-xl font-medium hover:bg-slate-50 transition-all">
                                Back to Types
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Result Step -->
                <div id="step-result" class="step-content hidden animate-fade-in">
                    <div class="flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4 border-b border-slate-100 pb-6">
                        <div class="text-left">
                            <h2 class="text-xl font-bold text-slate-800">Solution Details</h2>
                            <p class="text-slate-500 text-sm mt-1">
                                Customized recommendation based on <span id="summary-text" class="font-bold text-blue-600"></span>
                            </p>
                        </div>
                        <div class="flex items-center gap-3 no-print">
                            <button onclick="goBackToStep('step-params', 75)" class="px-4 py-2.5 bg-white border border-slate-200 text-slate-600 rounded-xl text-sm font-bold hover:bg-slate-50 transition-all flex items-center shadow-sm">
                                <i class="fas fa-arrow-left mr-2"></i>Back
                            </button>
                            <button onclick="resetApp()" class="px-4 py-2.5 bg-slate-100 text-slate-600 rounded-xl text-sm font-bold hover:bg-slate-200 transition-all flex items-center shadow-sm">
                                <i class="fas fa-home mr-2"></i>Home
                            </button>
                        </div>
                    </div>

                    <div id="printable-area" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- Budget Plan -->
                        <div class="flex flex-col">
                            <div class="bg-blue-600 text-white p-4 rounded-t-3xl font-bold flex items-center justify-between">
                                <span class="flex items-center"><i class="fas fa-wallet mr-2"></i> Budget Plan</span>
                                <span class="text-[10px] bg-white/20 px-2 py-0.5 rounded-full border border-white/30 backdrop-blur-sm">Cost-effective</span>
                            </div>
                            <div class="bg-white border-x border-b border-slate-100 p-6 rounded-b-3xl custom-shadow flex-grow flex flex-col">
                                <div id="plan-entry-items" class="space-y-3 flex-grow"></div>
                                <div class="mt-8 pt-6 border-t border-slate-100">
                                    <div class="text-slate-400 text-xs mb-1 uppercase tracking-tight">Estimated Investment</div>
                                    <div class="text-3xl font-bold text-slate-900" id="total-price-entry">--</div>
                                </div>
                            </div>
                        </div>
                        <!-- High Performance Plan -->
                        <div class="flex flex-col">
                            <div class="bg-slate-900 text-white p-4 rounded-t-3xl font-bold flex items-center justify-between">
                                <span class="flex items-center"><i class="fas fa-rocket mr-2 text-orange-400"></i> Performance Plan</span>
                                <span class="text-[10px] bg-orange-500/20 px-2 py-0.5 rounded-full border border-orange-500/30 backdrop-blur-sm text-orange-200">Premium Experience</span>
                            </div>
                            <div class="bg-white border-x border-b border-slate-100 p-6 rounded-b-3xl custom-shadow flex-grow flex flex-col">
                                <div id="plan-pro-items" class="space-y-3 flex-grow"></div>
                                <div class="mt-8 pt-6 border-t border-slate-100">
                                    <div class="text-slate-400 text-xs mb-1 uppercase tracking-tight">Estimated Investment</div>
                                    <div class="text-3xl font-bold text-slate-900" id="total-price-pro">--</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Engineer Required -->
                <div id="step-engineer" class="step-content hidden animate-fade-in text-center py-12 no-print">
                    <div class="w-20 h-20 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center mx-auto mb-6 text-3xl">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">Expert Support Required</h2>
                    <p class="text-slate-500 max-w-md mx-auto mb-8">
                        The current scale (<span id="eng-area"></span>㎡ / <span id="eng-staff"></span> people) exceeds the quick recommendation range. Professional network planning is required.
                    </p>
                    <button onclick="goBackToStep('step-params', 75)" class="w-full max-w-xs py-4 bg-slate-800 text-white rounded-xl font-bold hover:bg-slate-700 transition-all">Back to Edit</button>
                </div>

            </div>
        </main>
        
        <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-6 py-3 rounded-full text-sm font-medium shadow-2xl opacity-0 translate-y-10 transition-all duration-300 z-[100] pointer-events-none">
            <span id="toast-message"></span>
        </div>
    </div>

    <script>
        let selections = {
            subScenario: '',
            area: 0,
            staff: 0
        };

        const catalog = {
            devices: {
                gateway: {
                    EG105GP: { model: "RG-EG105G-P", price: 699, icon: "fas fa-microchip", label: "Gigabit Gateway" },
                    EG310GH: { model: "RG-EG310GH-E", price: 1199, icon: "fas fa-microchip", label: "Core Gateway" },
                    EG310GHP: { model: "RG-EG310GH-P-E", price: 1299, icon: "fas fa-microchip", label: "High-Perf PoE Gateway" },
                    EG406XS: { model: "RG-EG406XS", price: 1699, icon: "fas fa-tachometer-alt", label: "10G Core Gateway" },
                    EG406XSP: { model: "RG-EG406XS-P", price: 1899, icon: "fas fa-tachometer-alt", label: "10G PoE Gateway" }
                },
                switch: {
                    ES210GSP: { model: "RG-ES210GS-P", price: 999, icon: "fas fa-server", label: "PoE Switch" },
                    ES209MGP: { model: "RG-ES209MG-P", price: 1599, icon: "fas fa-server", label: "2.5G PoE Switch" }
                },
                ap: {
                    RAP2260G: { model: "RG-RAP2260(G)", price: 899, icon: "fas fa-wifi", label: "Wi-Fi 6 AP" },
                    RAP2260E: { model: "RG-RAP2260(E)", price: 1099, icon: "fas fa-wifi", label: "Wi-Fi 6 AP" },
                    RAP2260: { model: "RG-RAP2260", price: 899, icon: "fas fa-wifi", label: "Wi-Fi 6 AP" },
                    RAP72: { model: "RG-RAP72", price: 1599, icon: "fas fa-bolt", label: "Wi-Fi 7 AP" },
                    RAP72Pro: { model: "RG-RAP72Pro", price: 2199, icon: "fas fa-bolt", label: "Wi-Fi 7 Pro AP" }
                }
            }
        };

        function goToParams(type) {
            selections.subScenario = type;
            hideAllSteps();
            document.getElementById('step-params').classList.remove('hidden');
            document.getElementById('type-info-badge').innerText = type === 'office_open' ? 'Open Plan' : 'Partitioned';
            updateProgressBar(75);
        }

        function validateAndCalculate() {
            const areaInput = document.getElementById('input-area');
            const staffInput = document.getElementById('input-staff');
            const area = parseFloat(areaInput.value) || 0;
            const staff = parseInt(staffInput.value) || 0;

            if (area < 1 || staff < 1) {
                showToast("Please enter valid area and staff numbers.");
                return;
            }

            selections.area = area;
            selections.staff = staff;

            if (area > 800 || staff > 100) {
                showEngineerSupport(area, staff);
                return;
            }

            renderResults();
        }

        function calculateAPCount(area, divisor) {
            const factor = area / divisor;
            const decimal = factor - Math.floor(factor);
            let n = (decimal > 0.3) ? Math.ceil(factor) : Math.floor(factor);
            return Math.max(n, 1);
        }

        function renderResults() {
            let planData = { entry: { items: [] }, pro: { items: [] } };
            const { area, staff, subScenario } = selections;
            let subLabel = subScenario === 'office_open' ? "Open Plan" : "Partitioned";

            if (subScenario === 'office_open') {
                const n = calculateAPCount(area, 100);
                if (area > 300) {
                    const m0 = Math.ceil(n / 5);
                    const m1 = Math.ceil(n / 4);
                    planData.entry.items = [{ ...catalog.devices.gateway.EG310GH, qty: 1 }, { ...catalog.devices.switch.ES210GSP, qty: m0 }, { ...catalog.devices.ap.RAP2260, qty: n }];
                    planData.pro.items = [{ ...catalog.devices.gateway.EG406XS, qty: 1 }, { ...catalog.devices.switch.ES209MGP, qty: m1 }, { ...catalog.devices.ap.RAP72Pro, qty: n }];
                } else if (staff >= 51) {
                    planData.entry.items = [{ ...catalog.devices.gateway.EG310GHP, qty: 1 }, { ...catalog.devices.ap.RAP2260E, qty: n }];
                    planData.pro.items = [{ ...catalog.devices.gateway.EG406XSP, qty: 1 }, { ...catalog.devices.ap.RAP72Pro, qty: n }];
                } else {
                    planData.entry.items = [{ ...catalog.devices.gateway.EG105GP, qty: 1 }, { ...catalog.devices.ap.RAP2260G, qty: n }];
                    planData.pro.items = [{ ...catalog.devices.gateway.EG406XSP, qty: 1 }, { ...catalog.devices.ap.RAP72, qty: n }];
                }
            } 
            else if (subScenario === 'office_rooms') {
                const n_rooms = calculateAPCount(area, 50); 
                if (area >= 151) {
                    const m_entry = Math.ceil(n_rooms / 6);
                    const m_pro = Math.ceil(n_rooms / 4);
                    planData.entry.items = [{ ...catalog.devices.gateway.EG310GH, qty: 1 }, { ...catalog.devices.switch.ES210GSP, qty: m_entry }, { ...catalog.devices.ap.RAP2260, qty: n_rooms }];
                    planData.pro.items = [{ ...catalog.devices.gateway.EG406XS, qty: 1 }, { ...catalog.devices.switch.ES209MGP, qty: m_pro }, { ...catalog.devices.ap.RAP72Pro, qty: n_rooms }];
                } else {
                    if (staff <= 50) {
                        planData.entry.items = [{ ...catalog.devices.gateway.EG105GP, qty: 1 }, { ...catalog.devices.ap.RAP2260G, qty: n_rooms }];
                        planData.pro.items = [{ ...catalog.devices.gateway.EG406XSP, qty: 1 }, { ...catalog.devices.ap.RAP72, qty: n_rooms }];
                    } else {
                        showEngineerSupport(area, staff);
                        return;
                    }
                }
            }
            displayResults(planData, subLabel);
        }

        function displayResults(data, subLabel) {
            hideAllSteps();
            document.getElementById('progress-container').classList.add('hidden');
            document.getElementById('step-result').classList.remove('hidden');
            document.getElementById('summary-text').innerText = `${selections.area}㎡ / ${selections.staff} Staff (${subLabel})`;

            renderPlanColumn('plan-entry-items', data.entry.items, 'blue');
            renderPlanColumn('plan-pro-items', data.pro.items, 'slate');

            const totalEntry = data.entry.items.reduce((sum, i) => sum + (i.price * i.qty), 0);
            const totalPro = data.pro.items.reduce((sum, i) => sum + (i.price * i.qty), 0);

            if (totalEntry < totalPro) {
                document.getElementById('total-price-entry').innerText = '$$';
                document.getElementById('total-price-pro').innerText = '$$$';
            } else if (totalEntry > totalPro) {
                document.getElementById('total-price-entry').innerText = '$$$';
                document.getElementById('total-price-pro').innerText = '$$';
            } else {
                document.getElementById('total-price-entry').innerText = '$$';
                document.getElementById('total-price-pro').innerText = '$$';
            }
        }

        function renderPlanColumn(containerId, items, color) {
            const container = document.getElementById(containerId);
            const iconBg = color === 'blue' ? 'bg-blue-50 text-blue-600' : 'bg-slate-100 text-slate-800';
            container.innerHTML = items.map(item => `
                <div class="flex items-center p-4 bg-slate-50 rounded-2xl border border-slate-100">
                    <div class="w-10 h-10 ${iconBg} rounded-xl flex items-center justify-center mr-4">
                        <i class="${item.icon}"></i>
                    </div>
                    <div class="flex-grow">
                        <div class="text-[10px] text-slate-400 font-bold uppercase tracking-tight">${item.label}</div>
                        <div class="font-bold text-sm">${item.model}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-[10px] text-slate-400">Qty</div>
                        <div class="font-bold text-blue-600">${item.qty} <span class="text-xs font-normal text-slate-400">unit</span></div>
                    </div>
                </div>
            `).join('');
        }

        function showEngineerSupport(area, staff) {
            hideAllSteps();
            document.getElementById('eng-area').innerText = area;
            document.getElementById('eng-staff').innerText = staff;
            document.getElementById('step-engineer').classList.remove('hidden');
            document.getElementById('progress-container').classList.add('hidden');
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            const msgSpan = document.getElementById('toast-message');
            msgSpan.innerText = msg;
            toast.classList.remove('opacity-0', 'translate-y-10');
            toast.classList.add('opacity-100', 'translate-y-0');
            
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-10');
                toast.classList.remove('opacity-100', 'translate-y-0');
            }, 3000);
        }

        function goBackToStep(stepId, progress) {
            hideAllSteps();
            document.getElementById('progress-container').classList.remove('hidden');
            document.getElementById(stepId).classList.remove('hidden');
            updateProgressBar(progress);
        }

        function hideAllSteps() {
            document.querySelectorAll('.step-content').forEach(s => s.classList.add('hidden'));
        }

        function updateProgressBar(val) {
            document.getElementById('progress-bar').style.width = val + '%';
            document.getElementById('step-percentage').innerText = val + '%';
        }

        function resetApp() { location.reload(); }
    </script>
</body>
</html>
